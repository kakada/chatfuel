!!!
%html{lang: I18n.locale}
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}
    = Gon::Base.render_data
    %meta{ name: "turbolinks-visit-control", content: "reload" }
    = display_meta_tags SocialMetaTag.to_meta_tags
    = csrf_meta_tags
    = csp_meta_tag
    = stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload'
    = javascript_pack_tag 'application', 'data-turbolinks-track': 'reload'
  %body{ id: css_class_name, style: 'overflow-y: scroll' }
    = content_tag :a, nil, id: "link"
    #main-content.position-relative
      = render "welcomes/switch_lang"
      #logo-container.mb-5
        .container
          .text-center
            = render partial: "welcomes/logo", locals: { tabindex: 1, id: "link-to-usaid-logo" }
      = yield
    
    - if Rails.env.production?
      = render "welcomes/chatbot_short_into"
    :javascript
      let { dev, isEmbed } = OWSO.Util
      if( !dev() && !isEmbed() ) {
        if( $(".fb-customerchat").length == 0 ) {
          var div = document.createElement('div');
          div.className = 'fb-customerchat';
          div.setAttribute('page_id', '#{ENV["FACEBOOK_PAGE_ID"]}');
          div.setAttribute('ref', '');
          div.setAttribute('theme_color', '#002f6c')
          document.body.appendChild(div);
        }
        window.fbMessengerPlugins = window.fbMessengerPlugins || {
          init: function () {
            FB.init({
              appId            : '#{ENV["FACEBOOK_APP_ID"]}',
              autoLogAppEvents : true,
              xfbml            : true,
              version          : 'v8.0'
            });
          }, callable: []
        };
        window.fbAsyncInit = window.fbAsyncInit || function () {
          window.fbMessengerPlugins.callable.forEach(function (item) { item(); });
          window.fbMessengerPlugins.init();
        };
        setTimeout(function () {
          (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement(s);
            js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk/xfbml.customerchat.js";
            fjs.parentNode.insertBefore(js, fjs);
          }(document, 'script', 'facebook-jssdk'));
        }, 0);
      }
