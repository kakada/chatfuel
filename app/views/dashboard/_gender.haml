.col-xl-4.col-lg-5
  .card.shadow.mb-4
    .card-header.py-3.d-flex.flex-row.align-items-center.justify-content-between
      .h5.m-0.font-weight-bold.text-primary
        = t("dashboard.total_user_gender")

      .tools.d-flex.align-items-center
        %span.mr-2.badge.badge-primary
          = VariableValue.criteria.first.variable.name
          &raquo;
          = VariableValue.criteria.first.mapping_value

        - if @query.users_visited_by_each_genders.present?
          = link_to "#", class: "chart-dl text-dark", "data-target": "#users_visited_by_genders" do
            %i.fa.fa-download

        - if policy(:dashboard).setting?
          = link_to "#", class: "ml-2", data: { toggle: "modal", target: "#chooseDictionary" } do
            %i.fas.fa-cog.cog
    .card-body
      #users_visited_by_genders.pt-4.d-flex.justify-content-around.align-items-center
        - agg_genders = @query.users_visited_by_each_genders

        - if agg_genders.present?
          %ul.list-unstyled
            = render partial: "dashboard/overview/users_visited_by_each_genders", collection: agg_genders.keys, as: :mapped_gender

        = render 'choose_dictionary_value_modal', url: set_criteria_dictionaries_path, modal_id: 'chooseDictionary'
        = pie_chart agg_genders, width: "200px", height: "200px", legend: false, messages: { empty: t("no_data") }